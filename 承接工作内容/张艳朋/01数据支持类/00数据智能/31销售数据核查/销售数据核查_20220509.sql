select
	regexp_replace(substr(posting_time,1,7),'-','') smonth,
	opp_acc_name,
    customer_code, -- 客户编码
    company_code, -- 公司代码
    sum(paid_amount) as paid_amount
from  
	csx_dw.dwd_sss_r_d_money_back
where
	customer_code in ('120939','121276','121276','121276','121298','121625','121625','121625','122988','123244','123684','124498','124601','125272','125898','126111','126171',
	'126195','126298','126349','126378','126419','126455','126548','126790')
group by 
	regexp_replace(substr(posting_time,1,7),'-',''),opp_acc_name,customer_code,company_code
;
	
	
select 
	customer_no,child_customer_no,substr(sdt,1,6) as smonth,
	first_category_name,second_category_name,third_category_name,
	shop_company_name,
	sum(sales_value) as sales_value,
	sum(excluding_tax_sales) as excluding_tax_sales,
	sum(excluding_tax_profit) as excluding_tax_profit
from 
	csx_dw.dws_sale_r_d_detail
where 
	channel_code in('1','7','9')
	and customer_no in ('120939','121276','121276','121276','121298','121625','121625','121625','122988','123244','123684','124498','124601','125272','125898','126111','126171',
	'126195','126298','126349','126378','126419','126455','126548','126790')
	and child_customer_no in ('Z031392','Z033020','Z033021','Z036174','Z033575','Z035728','Z039701','Z039702','Z034498','Z035119','Z045502','Z038586','Z039704','Z044841',
	'Z042646','Z045304','Z043380','Z043766','Z043836','Z043889','Z043956','Z044852','Z044025','Z044614','Z045303')
group by 
	customer_no,child_customer_no,substr(sdt,1,6),first_category_name,second_category_name,third_category_name,shop_company_name
;





select
	regexp_replace(substr(posting_time,1,7),'-','') smonth,
	opp_acc_name,
    customer_code, -- 客户编码
    company_code, -- 公司代码
    sum(paid_amount) as paid_amount
from  
	csx_dw.dwd_sss_r_d_money_back
where
	customer_code in ('114246','114246','120255','120404','120939','120999','121276','121276','121276','121276','121298','121398','121467','121475','121625','121625','121625',
	'122534','122567','122603','122623','122988','123244','123483','123533','123605','123987','124219','124473','124473','124498','124601','125161','125284','125898')
group by 
	regexp_replace(substr(posting_time,1,7),'-',''),opp_acc_name,customer_code,company_code
;
	
	
select 
	customer_no,child_customer_no,substr(sdt,1,6) as smonth,
	first_category_name,second_category_name,third_category_name,
	shop_company_name,
	sum(sales_value) as sales_value,
	sum(excluding_tax_sales) as excluding_tax_sales,
	sum(excluding_tax_profit) as excluding_tax_profit
from 
	csx_dw.dws_sale_r_d_detail
where 
	channel_code in('1','7','9')
	and customer_no in ('114246','114246','120255','120404','120939','120999','121276','121276','121276','121276','121298','121398','121467','121475','121625','121625','121625',
	'122534','122567','122603','122623','122988','123244','123483','123533','123605','123987','124219','124473','124473','124498','124601','125161','125284','125898')
	and child_customer_no in ('Z009145','Z031616','Z029700','Z033574','Z031392','Z031395','Z033020','Z033021','Z036174','Z036175','Z033575','Z031393','Z031394','Z031401',
	'Z035728','Z039701','Z039702','Z033738','Z033740','Z033739','Z033741','Z034498','Z035119','Z036122','Z035838','Z036018','Z037599','Z037787','Z039653','Z039654','Z038586',
	'Z039704','Z041100','Z040421','Z042646')
group by 
	customer_no,child_customer_no,substr(sdt,1,6),first_category_name,second_category_name,third_category_name,shop_company_name
;




select 
	customer_no,substr(sdt,1,6) as smonth,
	first_category_name,second_category_name,third_category_name,
	shop_company_name,
	sum(sales_value) as sales_value,
	sum(excluding_tax_sales) as excluding_tax_sales,
	sum(excluding_tax_profit) as excluding_tax_profit
from 
	csx_dw.dws_sale_r_d_detail
where 
	channel_code in('1','7','9')
	and customer_no in ('120939','121276','121276','121276','121298','121625','121625','121625','122988','123244','123684','124498','124601','125272','125898','126111','126171',
	'126195','126298','126349','126378','126419','126455','126548','126790','114246','120255','120404','120939','120999','121276','121298','121398','121467','121475','121625',
	'122534','122567','122603','122623','122988','123244','123483','123533','123605','123987','124219','124473','124498','124601','125161','125284','125898')
group by 
	customer_no,substr(sdt,1,6),first_category_name,second_category_name,third_category_name,shop_company_name
;
	
select
	regexp_replace(substr(posting_time,1,7),'-','') smonth,
    customer_code, -- 客户编码
    company_code, -- 公司代码
    sum(paid_amount) as paid_amount
from  
	csx_dw.dwd_sss_r_d_money_back
where
	customer_code in ('120939','121276','121276','121276','121298','121625','121625','121625','122988','123244','123684','124498','124601','125272','125898','126111','126171',
	'126195','126298','126349','126378','126419','126455','126548','126790','114246','120255','120404','120939','120999','121276','121298','121398','121467','121475','121625',
	'122534','122567','122603','122623','122988','123244','123483','123533','123605','123987','124219','124473','124498','124601','125161','125284','125898')
group by 
	regexp_replace(substr(posting_time,1,7),'-',''),customer_code,company_code
;	



select 
	customer_no,substr(sdt,1,6) as smonth,
	first_category_name,second_category_name,third_category_name,
	shop_company_name,
	sum(sales_value) as sales_value,
	sum(excluding_tax_sales) as excluding_tax_sales,
	sum(excluding_tax_profit) as excluding_tax_profit
from 
	csx_dw.dws_sale_r_d_detail
where 
	channel_code in('1','7','9')
	and customer_no in ('120939','121276','121276','121276','121298','121625','121625','121625','122988','123244','123684','124498','124601','125272','125898','126111','126171',
	'126195','126298','126349','126378','126419','126455','126548','126790','114246','120255','120404','120939','120999','121276','121298','121398','121467','121475','121625',
	'122534','122567','122603','122623','122988','123244','123483','123533','123605','123987','124219','124473','124498','124601','125161','125284','125898')
group by 
	customer_no,substr(sdt,1,6),first_category_name,second_category_name,third_category_name,shop_company_name

	
select
	regexp_replace(substr(posting_time,1,7),'-','') smonth,
    customer_code, -- 客户编码
    company_code, -- 公司代码
    sum(paid_amount) as paid_amount
from  
	csx_dw.dwd_sss_r_d_money_back
where
	customer_code in ('120939','121276','121276','121276','121298','121625','121625','121625','122988','123244','123684','124498','124601','125272','125898','126111','126171',
	'126195','126298','126349','126378','126419','126455','126548','126790','114246','120255','120404','120939','120999','121276','121298','121398','121467','121475','121625',
	'122534','122567','122603','122623','122988','123244','123483','123533','123605','123987','124219','124473','124498','124601','125161','125284','125898')
group by 
	regexp_replace(substr(posting_time,1,7),'-',''),customer_code,company_code
;

select
	distinct customer_code,customer_name,opp_acc_name
from  
	csx_dw.dwd_sss_r_d_money_back
where
	customer_code in ('124688','106898','115206','107946','111118','PF1209','115865','107934','117332','118094','115178','115476','117087','114044','101585','123528','114843',
	'123084','112664','123429','114038','118610','116123','121255','119216','124039','118781','106876','110696','112315','124359','100326','102924','122860','122247','120836',
	'123706','109977','122116','111864','124212','111707','117406','113476','122357','105518','124799','122347','106516','125276','124541','120048','121304','112281','124068',
	'111647','124517','107058','124998','123722','120575','103717','104631','123803','102706','115047','116350','109734','109801','108883','114873','109509','123133','112472',
	'124546','115527','107339','123586','120260','120333','112148','115941','117911','112658','125370','121765','123755','115073','117516','104217','115195','125853','125882',
	'115753','124330','124527','124557','124221','107034','107453','120376','114273','125579','107674','123997','122143','116141','123977','117534','105173','109406','123963',
	'107461','123485','108480','114535','122282','118136','119428','122601','125313','112722','120455','119998','117722','108922','108236','124414','112010','120365','111261',
	'123420','121173','125496','105633','108795','116150','122763','124618','125704','122754','108732','118823','107798','121849','118937','108176','117264','117842','120345',
	'125508','119865','107500','113202','108960','112317','120310','122869','115236','117894','122901','105307','122985','124579','119401','125134','117238','107593','124081',
	'122555','123261','122599','105820','125650','124015','119734','123534','126307','116847','124433','123874','111781','106495','118687','114940','119865','119326','120008',
	'118219','122870','124792','121391','125874','118303','125184','116413','123876','116292','122135','111365','120460','120959','125635','116882','114060','126341','124623',
	'124263','111856','118744','125121','125943','119887','125202','123875','118836','123048','124061','123232','113217','125616','116788','116755','122965','125642','121099',
	'124894','124593','119118','115191','104569','119519','119122','117353','119237','116889','120337','115885','114269','125626','120294','120476','108853','112680','118057',
	'120878','108021','126050','123655','125895','113260','124386','121190','118940')
;

select
	distinct customer_code,customer_name,opp_acc_name
from  
	csx_dw.dwd_sss_r_d_money_back
where
	customer_code in ('105164','107404','105156','106721','105182','119990','105165','105181','103207','120548','120544','120536','106423','105150','103145','114090',
	'118318','113857','106921','119897')
;


select
	distinct customer_code,customer_name,opp_acc_name
from  
	csx_dw.dwd_sss_r_d_money_back
where
	customer_code in ('114244','122809','116177','117103','119032','118602','121578','114548','119695','118022','123311','115352','123086','122817','113809','119661','113758',
	'118918','118376','123035','120487','106775','124524','116655','119485','115168','125510','113870','118892','115293','114540','113906','118705','115532','118730','117017',
	'122614','123629','114586','124278','118961','114718','119376','114613','122619','121267','105696','114387','120490','111608','121292','119811','122600','118084','110808',
	'122564','112554','118912','115947','124033','118072','119377','121667','120595','124183','113456','124085','124584','117405','105687','105695','125029','122613','113837',
	'118911','118913','118504','107555','118682','120755','117354','118529','113032','122626','122322','123383','122618','122579','125406','106214','125028','105686','119739',
	'119853','120930','119434','112285','116932','PF0937','119980','120123','122610','117450','107956','117114','122622','117927','122581','117221','112629','122523','122696',
	'124885','119898','123604','118466','122799','123019','125676','126124','123159','118654','119755','122469','125288','120416','125017','114785','125687','121276','113850',
	'124821','120607','123711','124668','124830','117374','125718','123328','117448','114777','115620','125007','113779','124784','115188','120823','124606','114693','114706',
	'114528','118907','125618','120830','114473','125467','114898','124353','116845','121508','120666','124793','122697','123923','120366','123158','118469','125128','114670',
	'119657','122837','123038','117091','124505','116038','118693','113602','123631','106964','125591','109816','119261','125215','107150','124669','114663','120054','124394',
	'115703','117424','120380','119225','126000','118689','118457','120589','123566','122595','122612','119295','114665','115369','125394','117761','118934','106299','114042',
	'117805','117384','116051','120103','115768','112276','121479','114816','107949','106325','111058','117208','123507','118694','118653','123342','117784','115692','122605',
	'124577','117777','124230','117193','124474','124231','117729','123633','106309','122993','116055','117728','103997','122993','116056','106298','119264','125748','117444',
	'116032','124650','118915','123692','117766','117748','116061','125914','117776','117226','122988','106081','124044','125301','117349','117790','104965','117796','125233',
	'112813','117132','123050','117749','118897','117786','118396','106321','124211','106326','117548','117783','117782','125873','124004','125306','106283','117727','125629',
	'126387','124638','106330','117800','118748','121015','117795','117773','125226','118829','106306','117791','117781','117753','126047','123395','117785','120220','125795',
	'121023','126171','122738','123974','106320','104179','116275','126195','126147','117628','120101','116485','124597','124899','106284','PF1265','119689','125585','122620',
	'121425','125784','117918','114642','125327','103271','125801','119644','117192','124553','118975','126327','126396','125668','106308','126383','126360','124493','125421',
	'106307','117133','106301','122459','112905','105202','111931','122180','117120','120090','126364','116522','120286','117002','119842','118676')
;


insert overwrite directory '/tmp/zhangyanpeng/20220512_01_01' row format delimited fields terminated by '\t'
select 
	customer_no,customer_name,substr(sdt,1,4) as syear,
	shop_company_name,
	sum(sales_value) as sales_value,
	sum(excluding_tax_sales) as excluding_tax_sales,
	sum(excluding_tax_profit) as excluding_tax_profit
from 
	csx_dw.dws_sale_r_d_detail
where 
	channel_code in('1','7','9')
	and sdt>='20210101' and sdt<='20220511'
group by 
	customer_no,customer_name,substr(sdt,1,4),shop_company_name;

	
insert overwrite directory '/tmp/zhangyanpeng/20220512_01_02' row format delimited fields terminated by '\t'	
select
	regexp_replace(substr(posting_time,1,4),'-','') syear,
    customer_code, -- 客户编码
    company_code, -- 公司代码
	opp_acc_name,
    sum(paid_amount) as paid_amount
from  
	csx_dw.dwd_sss_r_d_money_back
where
	substr(posting_time,1,4)>='2021'
group by 
	regexp_replace(substr(posting_time,1,4),'-',''),customer_code,company_code,opp_acc_name
;


	
