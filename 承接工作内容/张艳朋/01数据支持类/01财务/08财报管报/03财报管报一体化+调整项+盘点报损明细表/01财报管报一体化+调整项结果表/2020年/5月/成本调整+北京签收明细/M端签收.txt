SELECT 
 a.credential_no  as '商品凭证编号',
 null AS 'WMS收发货批次号',
 a.product_code as '商品编码',
 a.product_name as '商品名称',
 a.posting_time as '记账日期',
 a.create_by as '订单创建人',
 a.source_order_no as '订单号',
 a.orig_source_order_no as '原订单单号',
 a.out_order_no as '关联单号',
 a.source_order_type as '订单类型',
 b.company_code AS '客户公司编码',
 c.`name` as '客户公司名称',
 a.customer_no as '客户编码',
 a.customer_name as '客户名称',
 a.sub_customer_no as '子客户编码',
 a.sub_customer_name as '子客户名称',
 a.create_time as '订单创建时间',
 a.sign_company_code AS '签约公司编码',
 a.sign_company_name AS '签约公司名称',
 a.contract_location_code AS '履约地点',
 a.contract_location_name AS '履约地点名称',
 a.company_code AS '发货地点公司代码',
 a.company_name AS '发货地点公司名称',
 a.location_code AS '发货地点',
 a.location_name AS '发货地点名称',
 a.remark AS '备注',
 a.return_reason as '退货原因',
 a.logistics_mode AS '物流模式',
 a.replenish_type AS '是否补单',
 a.bar_code AS '条码',
 a.spec as '规格',
 a.number_of_packages as '件装数',
 a.unit as '单位',
 a.qty AS '数量',
 a.root_category as '部类',
 a.purchase_group_code as '采购组编码',
 a.purchase_group_name as '采购组名称',
 a.small_category_code as '小类编码',
 a.small_category_name as '小类名称',
 null as '不含税售价',
 a.sale_order_price as '含税售价',
 a.tax_code AS '税码',
 a.tax_rate AS '税率',
 a.sale_amt_no_tax as '不含税销售金额',
 a.sale_amt as '含税销售金额',
 null AS '不含税成本单价',
 null as '含税成本单价',
 a.cost_amt_no_tax as '不含税成本',
 a.cost_amt  as '含税成本',
 a.sale_amt_no_tax-a.cost_amt_no_tax AS '利润'
FROM
data_sync.data_relation_cas_sale_receiving_credential a  
LEFT JOIN csx_basic_data.md_all_shop_info b ON a.customer_no=b.location_code
LEFT JOIN csx_basic_data.md_yh_company_code c ON b.company_code=c.`code`
WHERE
 a.posting_time>='2020-05-01 00:00:00'
 AND a.posting_time<'2020-05-31 59:59:59'
 and a.source_sys='3'