drop table if exists csx_analyse_tmp.csx_analyse_tmp_b_category_sale_customer_detail;
create table csx_analyse_tmp.csx_analyse_tmp_b_category_sale_customer_detail
as	

				select
					business_type_name,order_channel_detail_name,delivery_type_name,agreement_dc_code,customer_code,customer_name,sdt,goods_code,goods_name,
					unit_name,classify_middle_name,
					sum(sale_qty) as sale_qty,
					sum(sale_amt) as sale_amt,
					sum(profit) as profit
				from
					csx_dws.csx_dws_sale_detail_di
				where 
					sdt between '20230801' and '20230918'
					and channel_code in ('1','7','9') 
					and customer_code in ('193',
'438',
'441',
'457',
'531',
'607',
'4730',
'6575',
'104268',
'104605',
'105024',
'105582',
'105686',
'105687',
'105695',
'105801',
'106693',
'106775',
'106877',
'106929',
'107058',
'107099',
'107567',
'107657',
'108096',
'108293',
'108417',
'108797',
'108824',
'110881',
'110910',
'111153',
'111207',
'111608',
'111647',
'111896',
'112177',
'112911',
'113873',
'113878',
'113935',
'113940',
'115178',
'115242',
'115315',
'115407',
'115537',
'115696',
'115826',
'116522',
'116904',
'117112',
'117244',
'117920',
'118208',
'118373',
'118610',
'118676',
'118689',
'118973',
'119138',
'119389',
'119426',
'119427',
'120085',
'120287',
'120416',
'120549',
'120623',
'120640',
'120641',
'120829',
'120957',
'121023',
'121057',
'121777',
'121821',
'121825',
'122176',
'122238',
'122773',
'123038',
'123116',
'123294',
'123573',
'124439',
'124483',
'124505',
'125096',
'125534',
'125926',
'126041',
'126705',
'127180',
'127255',
'127333',
'127391',
'127603',
'127629',
'127700',
'127842',
'127861',
'128108',
'128166',
'128175',
'128275',
'128359',
'128440',
'128452',
'128608',
'128754',
'128761',
'128995',
'129009',
'129020',
'129527',
'129547',
'129558',
'129642',
'129770',
'129792',
'129845',
'129910',
'129989',
'130075',
'130133',
'130300',
'130364',
'130451',
'130541',
'130644',
'130693',
'130843',
'130985',
'131016',
'131025',
'131427',
'131483',
'156201',
'164047',
'164281',
'165491',
'166682',
'168858',
'176923',
'177082',
'177991',
'181131',
'190351',
'190721',
'190768',
'191760',
'194075',
'194192',
'194213',
'194224',
'194227',
'194424',
'194428',
'194758',
'195022',
'195780',
'196051',
'197234',
'198304',
'211803',
'213984',
'221453',
'223283',
'223613',
'223790',
'224125',
'224556',
'224822',
'225094',
'226207',
'226602',
'226764',
'227192',
'227277',
'227394',
'227731',
'227766',
'228531',
'228602',
'228709',
'229053',
'229244',
'229846',
'229979',
'230441',
'231052',
'231318',
'231644',
'231946',
'232192',
'232375',
'232406',
'233156',
'233294',
'233843',
'234329',
'234336',
'234345',
'234352',
'234359',
'234428',
'234447',
'234466',
'234539',
'234625',
'234651',
'234685',
'234890',
'234896',
'234898',
'234907',
'234909',
'235310',
'235318',
'235320',
'235327',
'235341',
'235421',
'235461',
'235470',
'235474',
'235479',
'235503',
'788596',
'846612',
'846690',
'852411',
'852432',
'853526',
'854733',
'865127',
'920665',
'923264',
'963718',
'978201',
'1143969',
'1218519',
'1219301',
'1219835',
'1232928',
'1232930',
'1279021',
'1279211',
'1279430',
'1279445',
'1350194',
'1359849',
'1466072',
'1483527',
'1483602',
'1483603',
'1483710',
'1490779',
'1493135')
group by 
					business_type_name,order_channel_detail_name,delivery_type_name,agreement_dc_code,customer_code,customer_name,sdt,goods_code,goods_name,
					unit_name,classify_middle_name
;

select * from csx_analyse_tmp.csx_analyse_tmp_b_category_sale_customer_detail